<html>
	<head>
		<script src="/js/tools.js"></script>
		<script>
			var webSocketAddress = buildWebSocketAddress("status");
		</script>
		<script>
			var imageList = {};
			var websocket;
			var output;
		
			function init() {
			    output = document.getElementById("output");
			    openStatusSocket();
			}
			
			function updateImages(imageList) {
				while (output.firstChild) {
 					output.removeChild(output.firstChild);
				}
				
				for (var index in imageList) {
					var imgTag = document.createElement("img");
					imgTag.setAttribute("style", "max-width: 200pt; max-height: 200pt;");
					imgTag.setAttribute("src", "image/" + imageList[index]);
					output.appendChild(imgTag);
				}
			}
			
			function openStatusSocket() {
			    websocket = new WebSocket(webSocketAddress);
			    
			    websocket.onopen = function(evt) {
			    };
			    websocket.onmessage = function(evt) {
			    	imageList = JSON.parse(evt.data);
					updateImages(imageList);
			    };
			    websocket.onerror = function(evt) {
			    };
			    websocket.onclose = function(evt) {
			    };
			}
			
			function sendString() {
			    websocket.send(document.getElementById("string").value);
			    document.getElementById("string").value = "";
			}
		
			function writeToScreen(message) {
			    output.innerHTML = message;
			}
		
			window.addEventListener("load", init, false);
		</script>
</head>
<body>
	<input id="string" type="text" placeholder="enter string"></input>
	<button onclick="sendString();">send</button>
	<div id="output"/>
</body>
</html>  
        